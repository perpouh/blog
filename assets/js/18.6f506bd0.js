(window.webpackJsonp=window.webpackJsonp||[]).push([[18],{264:function(t,s,a){"use strict";a.r(s);var e=a(28),n=Object(e.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"qiitaの記事をvuepressに移管しました"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#qiitaの記事をvuepressに移管しました"}},[t._v("#")]),t._v(" Qiitaの記事をVuepressに移管しました")]),t._v(" "),a("p",[t._v("@mima_ita さんの記事 "),a("a",{attrs:{href:"https://qiita.com/mima_ita/items/ec33706c20f11a95516a",target:"_blank",rel:"noopener noreferrer"}},[t._v("Qiitaの記事をGitHubに移行する - Qiita"),a("OutboundLink")],1),t._v(" を読んで、もう一歩進めてみたくなったので書きます。"),a("br"),t._v("\nサルベージ後→GitHub Pages+VuePressで公開するお話です。"),a("br"),t._v("\nなお目的が元記事とはちょっとズレたところにあるのでPR出していません。")]),t._v(" "),a("h2",{attrs:{id:"vuepressの準備"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#vuepressの準備"}},[t._v("#")]),t._v(" Vuepressの準備")]),t._v(" "),a("p",[t._v("既にあるので割愛します。公式の手順に従ってください。")]),t._v(" "),a("h2",{attrs:{id:"qiita-exporterの準備"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#qiita-exporterの準備"}},[t._v("#")]),t._v(" qiita_exporterの準備")]),t._v(" "),a("p",[a("a",{attrs:{href:"https://qiita.com/mima_ita/items/ec33706c20f11a95516a",target:"_blank",rel:"noopener noreferrer"}},[t._v("Qiitaの記事をGitHubに移行する"),a("OutboundLink")],1),t._v("を参考に行ってください。"),a("br"),t._v("\nアクセストークン取得の際は "),a("code",[t._v("read_qiita")]),t._v(" と "),a("code",[t._v("write_qiita")]),t._v(" のふたつにチェックを入れました。")]),t._v(" "),a("p",[t._v("あと、元のコードのままだと私の環境では動かなかったので、ファイル先頭に")]),t._v(" "),a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# -*- coding: utf-8 -*-")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# %%")]),t._v("\n")])])]),a("p",[t._v("を入れました。このあたりって環境によるのかしらん？")]),t._v(" "),a("h2",{attrs:{id:"画像ファイル保存先の変更"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#画像ファイル保存先の変更"}},[t._v("#")]),t._v(" 画像ファイル保存先の変更")]),t._v(" "),a("p",[t._v("画像は "),a("code",[t._v("image")]),t._v(" ではなく "),a("code",[t._v(".vuepress/public/assets/img")]),t._v(" に保存したいのでパスを書き換えます。"),a("br"),t._v("\n表示は "),a("code",[t._v("/blog/assets/img/")]),t._v(" になります(vuepressの設定にもよる)"),a("br"),t._v("\nあんまりハードコードしたくない気はするんですけど、何回も使う種類のスクリプトじゃないし別にいいかあと思ってガリガリ書いています。")]),t._v(" "),a("div",{staticClass:"language-diff extra-class"},[a("pre",{pre:!0,attrs:{class:"language-diff"}},[a("code",[a("span",{pre:!0,attrs:{class:"token unchanged"}},[t._v("    if not os.path.exists(dst):\n        os.mkdir(dst)\n")]),a("span",{pre:!0,attrs:{class:"token deleted-sign deleted"}},[t._v("-   if not os.path.exists(dst + '/image'):\n-       os.mkdir(dst + '/image')\n")])])])]),a("div",{staticClass:"language-diff extra-class"},[a("pre",{pre:!0,attrs:{class:"language-diff"}},[a("code",[t._v("def fix_image(dst_folder, line):\n"),a("span",{pre:!0,attrs:{class:"token unchanged"}},[t._v('    """Qiitaのサーバーの画像ファイルから自分のリポジトリのファイルを表示するように修正する."""\n    images = re.findall(r\'https://qiita-image-store.+?\\.(?:png|gif|jpeg|jpg)\', line)\n    if not images:\n        return line\n    for url in images:\n        name = url.split("/")[-1]\n')]),a("span",{pre:!0,attrs:{class:"token deleted-sign deleted"}},[t._v("-        download(url, dst_folder + '/image/' + name)\n")]),a("span",{pre:!0,attrs:{class:"token inserted-sign inserted"}},[t._v("+        download(url, dst_folder + '/../.vuepress/public/assets/img/' + name)\n")]),a("span",{pre:!0,attrs:{class:"token unchanged"}},[t._v("        ix = line.find(url)\n")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token deleted-sign deleted"}},[t._v("-        line = line.replace(url, '/image/' + name)\n")]),a("span",{pre:!0,attrs:{class:"token inserted-sign inserted"}},[t._v("+        line = line.replace(url, '/blog/assets/img/' + name)\n")]),a("span",{pre:!0,attrs:{class:"token unchanged"}},[t._v("    return line\n")])])])]),a("p",[t._v("タイトルと日付を本文に含めたかったので以下を追加。")]),t._v(" "),a("div",{staticClass:"language-diff extra-class"},[a("pre",{pre:!0,attrs:{class:"language-diff"}},[a("code",[a("span",{pre:!0,attrs:{class:"token unchanged"}},[t._v("    for i in items:\n        text = fix_markdown(github_url, dst, i['body'], dict_title)\n        with open(dst + '/' + i['title'] + '.md', 'w', encoding='utf-8') as md_file:\n            md_file.write(\"#\" + i['title'] + \"\\n\")\n")]),a("span",{pre:!0,attrs:{class:"token inserted-sign inserted"}},[t._v("+           md_file.write(\"最終更新日:\" + datetime.strptime(i['updated_at'], '%Y-%m-%dT%H:%M:%S+09:00').strftime('%Y年%m月%d日') + \"\\n\\n\")\n+           md_file.write(text)\n")])])])]),a("p",[t._v("ファイルが取れたのでここで一旦ビルドしてみて、大丈夫そうだということを確認しました。"),a("br"),t._v("\nURLが日本語なのだけちょっと気に食わないけどまあ、気にしない方向で。この先なんか不具合があったら直しましょう。")]),t._v(" "),a("h2",{attrs:{id:"サイドバーにリンクを作成する"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#サイドバーにリンクを作成する"}},[t._v("#")]),t._v(" サイドバーにリンクを作成する")]),t._v(" "),a("p",[t._v("記事への動線が無いのでリンクを作ります。"),a("br"),t._v("\n本当はコマンド一個でぺろっとやりたいけどまあこの程度のコピペは許容としますか……")]),t._v(" "),a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" os\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" __name__ "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'__main__'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  filelist "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" os"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("listdir"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'../blog/qiita'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" item "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" filelist"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 末尾3文字(.md)を取り除く")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("print")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"[\'qiita/"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v("item"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("\"', '\"")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v("item"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"\']"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("p",[t._v("こんなのが出ます。")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("['qiita/macでgit管理をはじめる', 'macでgit管理をはじめる'],\n...\n")])])]),a("p",[t._v(".DS_Storeまで入ってきてしまったのでそれは手作業で取り除きました。"),a("br"),t._v("\nこれを "),a("code",[t._v(".vuepress/config.js")]),t._v(" にコピペします。")]),t._v(" "),a("h2",{attrs:{id:"qiitaに引っ越し記事を投稿する"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#qiitaに引っ越し記事を投稿する"}},[t._v("#")]),t._v(" Qiitaに引っ越し記事を投稿する")]),t._v(" "),a("p",[t._v("しようと思ったんですけど、小心者なのでAPI絡みで失敗するのが怖すぎて（特に更新系は……）胃が痛くなったのでやめました。そのうち手動で書くかもしれません。"),a("br"),t._v("\n何しろめちゃくちゃにメンタルが弱いんだ……")])])}),[],!1,null,null,null);s.default=n.exports}}]);